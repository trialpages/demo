<!DOCTYPE html>
<html lang="tr" translate="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Geçmiş Tutmayan Mini Tarayıcı</title>
  <meta name="color-scheme" content="light dark" />
  <meta name="referrer" content="no-referrer" />
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <style>
    :root {
      --bg: #0a0a0a;
      --fg: #f5f5f5;
      --muted: #bdbdbd;
      --accent: #ffffff;
      --border: #2a2a2a;
    }
    @media (prefers-color-scheme: light) {
      :root { --bg:#ffffff; --fg:#0a0a0a; --muted:#6b7280; --accent:#000000; --border:#e5e7eb; }
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; }
    body {
      background: var(--bg);
      color: var(--fg);
      font: 16px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }
    .app {
      height: 100dvh; /* mobilde güvenli alan */
      display: grid;
      grid-template-rows: auto 1fr;
      gap: 8px;
      padding: clamp(8px, 2vw, 16px);
    }
    .bar {
      display: grid;
      grid-template-columns: auto 1fr auto;
      gap: 8px;
      align-items: center;
      background: transparent;
    }
    .controls {
      display: flex; gap: 6px; flex-wrap: wrap;
    }
    button, .btn {
      appearance: none; border: 1px solid var(--border); background: transparent; color: var(--fg);
      padding: 8px 10px; border-radius: 999px; cursor: pointer; font-weight: 600;
    }
    button:hover { filter: brightness(1.1); }
    button:active { filter: brightness(0.95); }

    .urlbox { display:flex; align-items:center; gap:8px; }
    input[type="url"] {
      width: 100%; padding: 10px 14px; border-radius: 12px; border: 1px solid var(--border);
      background: transparent; color: var(--fg); outline: none; font-weight: 600;
    }
    input::placeholder { color: var(--muted); }

    .frame-wrap {
      position: relative; height: 100%; border: 2px solid var(--border); border-radius: 20px; overflow: hidden;
    }
    .top-shadow { position:absolute; inset:0; pointer-events:none; box-shadow: inset 0 1px 0 rgba(255,255,255,0.05), inset 0 0 0 9999px rgba(0,0,0,0.00); border-radius: 20px;}

    iframe#view {
      position: absolute; inset: 0; width: 100%; height: 100%; border: 0; background: #fff;
    }

    .status {
      position: absolute; right: 10px; bottom: 10px; font-size: 12px; color: var(--muted); background: rgba(0,0,0,0.35);
      border: 1px solid var(--border); padding: 6px 8px; border-radius: 10px; backdrop-filter: blur(6px);
    }

    .row { display:flex; gap:6px; align-items:center; flex-wrap:wrap; }
    .spacer { width:8px; }
  </style>
</head>
<body>
  <div class="app" aria-label="Geçmiş Tutmayan Mini Tarayıcı">
    <div class="bar" role="group" aria-label="Kontrol Çubuğu">
      <div class="controls">
        <button id="back" title="Geri">⟨</button>
        <button id="fwd" title="İleri">⟩</button>
        <button id="reload" title="Yenile">⟳</button>
      </div>
      <div class="urlbox">
        <input id="addr" type="url" inputmode="url" autocomplete="off" autocapitalize="off" spellcheck="false"
               placeholder="https://… yaz ve Enter'a bas" aria-label="Adres çubuğu" />
        <button id="go" class="btn" title="Git">Git</button>
      </div>
      <div class="row">
        <button id="home" title="Ana sayfa">Ana</button>
        <button id="blank" title="Panik / Boş">Boş</button>
        <button id="fs" title="Tam ekran">⤢</button>
      </div>
    </div>

    <div class="frame-wrap">
      <iframe id="view"
              sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox"
              referrerpolicy="no-referrer" loading="eager" src="about:blank" allow="fullscreen">
      </iframe>
      <div class="top-shadow" aria-hidden="true"></div>
      <div class="status" id="status">Hazır</div>
    </div>
  </div>

  <script>
    // ————— Yardımcılar —————
    const $ = (sel) => document.querySelector(sel);
    const view = $("#view");
    const addr = $("#addr");
    const status = $("#status");

    // İsteğe bağlı proxy temeli — kendi endpoint’inizle değiştirin (Cloudflare Worker ya da Node). Boş bırakılırsa direkt yükler.
    let USE_PROXY = false;
    let PROXY_BASE = ""; // örn: "https://<worker-adresiniz>.workers.dev/?u="

    function normalizeUrl(input) {
      input = (input || "").trim();
      if (!input) return "about:blank";
      if (/^https?:\/\//i.test(input)) return input;
      if (/^[\w.-]+\.[a-z]{2,}(\/.*)?$/i.test(input)) return "https://" + input; // alanadı yazıldıysa https varsay
      try {
        // Alan adı değilse dokunma; (bilerek otomatik arama yapmıyoruz)
        return new URL(input).href;
      } catch { return "https://" + input; }
    }

    function buildTarget(u) {
      if (USE_PROXY && PROXY_BASE) return PROXY_BASE + encodeURIComponent(u);
      return u;
    }

    function setStatus(msg) { status.textContent = msg; }

    function load(u) {
      const url = normalizeUrl(u);
      // Üst sayfanın geçmişine kayıt eklememek için hash’i replace ediyoruz (opsiyonel, görsel amaçlı)
      try { history.replaceState(null, "", "#" + btoa(unescape(encodeURIComponent(url))).slice(0, 128)); } catch {}
      setStatus("Yükleniyor…");
      // İçeriği temizle & yeni src ata (bazı sitelerde yeniden yüklenmeyi tetiklemek için önce blank)
      view.src = "about:blank";
      setTimeout(() => { view.src = buildTarget(url); addr.value = url; }, 10);
    }

    // ————— Olaylar —————
    $("#go").addEventListener("click", () => load(addr.value));
    addr.addEventListener("keydown", (e) => { if (e.key === "Enter") load(addr.value); });
    $("#reload").addEventListener("click", () => { const cur = addr.value || "about:blank"; load(cur); });

    $("#home").addEventListener("click", () => load("https://example.org"));
    $("#blank").addEventListener("click", () => { view.src = "about:blank"; setStatus("Boş sayfa"); });

    // Çapraz kaynak kısıtı olmadan history kontrolü her zaman mümkün olmayabilir; destek varsa deneriz.
    $("#back").addEventListener("click", () => { try { view.contentWindow.history.back(); } catch {} });
    $("#fwd").addEventListener("click", () => { try { view.contentWindow.history.forward(); } catch {} });

    $("#fs").addEventListener("click", async () => {
      const container = document.documentElement;
      try { await (document.fullscreenElement ? document.exitFullscreen() : container.requestFullscreen()); } catch {}
    });

    // iframe yüklenme takibi
    view.addEventListener("load", () => setStatus("Yüklendi"));
    view.addEventListener("error", () => setStatus("Yüklenemedi"));

    // İlk açılışta boş sayfa
    load("about:blank");
  </script>
</body>
</html>