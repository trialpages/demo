<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Dilekçe Oluşturucu</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; }
        input, textarea { width: 100%; padding: 8px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer; }
    </style>
    <script src="https://cdn.jsdelivr.net/gh/evidenceprime/html-docx-js/dist/html-docx.js"></script>
</head>
<body>
    <div class="container">
        <h1>Dilekçe Oluşturucu</h1>
        
        <div class="form-group">
            <label>Başlık:</label>
            <input type="text" id="baslik" placeholder="Dilekçe Başlığı" required>
        </div>
        
        <div class="form-group">
            <label>Dilekçe Metni:</label>
            <textarea id="metin" rows="6" placeholder="Dilekçe içeriğini yazınız" required></textarea>
        </div>
        
        <div class="form-group">
            <label>Adres ve İletişim Bilgileri:</label>
            <textarea id="adres" rows="3" placeholder="Adres ve iletişim bilgileri" required></textarea>
        </div>
        
        <div class="form-group">
            <label>Tarih:</label>
            <input type="date" id="tarih" required>
        </div>
        
        <div class="form-group">
            <label>Adınız Soyadınız:</label>
            <input type="text" id="isim" placeholder="Ad Soyad" required>
        </div>
        
        <button onclick="generateDocx()">Word Oluştur ve İndir</button>
    </div>

    <script>
        async function generateProperDocx() {
            const { Document, Packer, Paragraph, TextRun, AlignmentType } = docx;

            // Belge yapısını doğrudan oluşturma
            const doc = new Document({
                sections: [{
                    properties: {},
                    children: [
                        new Paragraph({
                            text: document.getElementById('baslik').value,
                            alignment: AlignmentType.CENTER,
                            heading: "Heading1",
                            spacing: { after: 400 }
                        }),
                        new Paragraph({
                            children: [
                                new TextRun({
                                    text: document.getElementById('metin').value,
                                    break: 1
                                }),
                                new TextRun({
                                    text: "\nBilgi ve gereğini sayılarımla arz ederim.",
                                    bold: true
                                })
                            ],
                            alignment: AlignmentType.BOTH,
                            spacing: { line: 360 }
                        }),
                        new Paragraph({
                            text: document.getElementById('adres').value.replace(/\n/g, '\n'),
                            alignment: AlignmentType.LEFT
                        }),
                        new Paragraph({
                            text: document.getElementById('tarih').value,
                            spacing: { before: 400 }
                        }),
                        new Paragraph({
                            text: document.getElementById('isim').value,
                            alignment: AlignmentType.RIGHT,
                            spacing: { before: 800 }
                        })
                    ]
                }]
            });

            // Dosyayı oluştur ve indir
            const blob = await Packer.toBlob(doc);
            saveAs(blob, "dilekce.docx");
        }
    </script>
</body>
</html>