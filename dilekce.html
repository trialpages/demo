<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Dilekçe Oluşturucu</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; }
        input, textarea { width: 100%; padding: 8px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer; }
    </style>
    <!-- Docx kütüphanesi -->
    <script src="https://unpkg.com/docx@7.7.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Dilekçe Oluşturucu</h1>
        
        <!-- Form alanları aynı kalıyor -->
        
        <button onclick="generateProperDocx()">Word Oluştur ve İndir</button>
    </div>

    <script>
        async function generateProperDocx() {
            const { Document, Packer, Paragraph, TextRun, AlignmentType } = docx;

            // Belge yapısını doğrudan oluşturma
            const doc = new Document({
                sections: [{
                    properties: {},
                    children: [
                        new Paragraph({
                            text: document.getElementById('baslik').value,
                            alignment: AlignmentType.CENTER,
                            heading: "Heading1",
                            spacing: { after: 400 }
                        }),
                        new Paragraph({
                            children: [
                                new TextRun({
                                    text: document.getElementById('metin').value,
                                    break: 1
                                }),
                                new TextRun({
                                    text: "\nBilgi ve gereğini sayılarımla arz ederim.",
                                    bold: true
                                })
                            ],
                            alignment: AlignmentType.BOTH,
                            spacing: { line: 360 }
                        }),
                        new Paragraph({
                            text: document.getElementById('adres').value.replace(/\n/g, '\n'),
                            alignment: AlignmentType.LEFT
                        }),
                        new Paragraph({
                            text: document.getElementById('tarih').value,
                            spacing: { before: 400 }
                        }),
                        new Paragraph({
                            text: document.getElementById('isim').value,
                            alignment: AlignmentType.RIGHT,
                            spacing: { before: 800 }
                        })
                    ]
                }]
            });

            // Dosyayı oluştur ve indir
            const blob = await Packer.toBlob(doc);
            saveAs(blob, "dilekce.docx");
        }
    </script>
</body>
</html>