<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ders Programı Hazırlayıcı</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
body {
  font-family: 'Segoe UI', Arial, sans-serif;
  background: #f5f7fa;
  color: #222;
  padding: 20px;
}
h1 {
  text-align: center;
  color: #005f73;
  margin-bottom: 15px;
}
.card {
  background: #ffffff;
  border-radius: 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  padding: 16px;
  margin-bottom: 16px;
}
input, select, button {
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #ccc;
  font-size: 14px;
}
input[type=file] {
  border: none;
}
button {
  background: #0ea5a4;
  color: #fff;
  border: none;
  font-weight: bold;
  cursor: pointer;
}
button:hover {
  background: #088f8d;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
}
th, td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: left;
}
th {
  background: #e2e8f0;
}
.logo-preview {
  width: 80px;
  height: 80px;
  border: 1px dashed #aaa;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  background: #fafafa;
  color: #888;
  font-size: 12px;
}
.flex {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  align-items: center;
}
</style>
</head>
<body>

<h1>Ders Programı Hazırlayıcı</h1>

<div class="card">
  <div class="flex">
    <div style="flex:1">
      <label>Okul / Kurum:</label><br>
      <input id="schoolName" type="text" placeholder="Örn: Marmara Üniversitesi İlahiyat Fakültesi" style="width:100%">
    </div>
    <div style="flex:1">
      <label>Öğretim Üyesi:</label><br>
      <input id="teacherName" type="text" placeholder="Ad Soyad" style="width:100%">
    </div>
    <div>
      <label>Okul Logosu:</label><br>
      <input id="logoInput" type="file" accept="image/*"><br>
      <div id="logoPreview" class="logo-preview">LOGO</div>
    </div>
  </div>
</div>

<div class="card">
  <div class="flex">
    <div>
      <label>Gün:</label><br>
      <select id="daySelect">
        <option>Pazartesi</option><option>Salı</option><option>Çarşamba</option>
        <option>Perşembe</option><option>Cuma</option><option>Cumartesi</option><option>Pazar</option>
      </select>
    </div>
    <div>
      <label>Saat:</label><br>
      <input id="timeInput" type="text" placeholder="09:00-10:30">
    </div>
    <div>
      <label>Ders:</label><br>
      <input id="courseInput" type="text" placeholder="Ders Adı">
    </div>
    <div>
      <label>Şube:</label><br>
      <input id="sectionInput" type="text" placeholder="A / 1. Sınıf / Grup 3">
    </div>
    <div>
      <label>&nbsp;</label><br>
      <button id="addBtn">Ekle</button>
    </div>
  </div>
</div>

<div class="card">
  <table id="table">
    <thead>
      <tr><th>Gün</th><th>Saat</th><th>Ders</th><th>Şube</th><th>Sil</th></tr>
    </thead>
    <tbody></tbody>
  </table>
  <br>
  <button id="downloadPdf">PDF Olarak Kaydet</button>
</div>

<script>
const { jsPDF } = window.jspdf;
const cart = [];
let logoDataURL = null;

// Logo yükleme
const logoInput = document.getElementById("logoInput");
const logoPreview = document.getElementById("logoPreview");
logoInput.addEventListener("change", (e)=>{
  const f = e.target.files[0];
  if(!f) return;
  const r = new FileReader();
  r.onload = ()=>{
    logoDataURL = r.result;
    logoPreview.innerHTML = '';
    const img = document.createElement('img');
    img.src = logoDataURL;
    img.style.maxWidth='100%';
    img.style.maxHeight='100%';
    logoPreview.appendChild(img);
  };
  r.readAsDataURL(f);
});

// Ders ekleme
document.getElementById("addBtn").onclick=()=>{
  const d=document.getElementById("daySelect").value;
  const t=document.getElementById("timeInput").value.trim();
  const c=document.getElementById("courseInput").value.trim();
  const s=document.getElementById("sectionInput").value.trim();
  if(!t || !c){alert("Ders adı ve saat giriniz.");return;}
  cart.push({day:d,time:t,course:c,section:s});
  render();
};

function render(){
  const tbody=document.querySelector("#table tbody");
  tbody.innerHTML="";
  cart.forEach((c,i)=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`<td>${c.day}</td><td>${c.time}</td><td>${c.course}</td><td>${c.section}</td>
    <td><button style='background:#ef4444;color:#fff' onclick='del(${i})'>Sil</button></td>`;
    tbody.appendChild(tr);
  });
}
function del(i){ cart.splice(i,1); render(); }

// PDF çıktısı
document.getElementById("downloadPdf").onclick=async()=>{
  if(cart.length===0){alert("Henüz ders eklenmedi!");return;}
  const school=document.getElementById("schoolName").value;
  const teacher=document.getElementById("teacherName").value;

  const printable=document.createElement("div");
  printable.style.background="#fff";
  printable.style.color="#000";
  printable.style.padding="20px";
  printable.innerHTML=`
    <div style='display:flex;justify-content:space-between;align-items:center;'>
      <div>
        <h2 style='margin:0'>${school}</h2>
        <div>Öğretim Üyesi: ${teacher}</div>
      </div>
      ${logoDataURL ? `<img src='${logoDataURL}' style='height:70px;'>` : ''}
    </div>
    <hr>
    <table style='width:100%;border-collapse:collapse;margin-top:10px'>
      <thead><tr style='background:#e2e8f0'>
        <th style='border:1px solid #ccc;padding:8px'>Gün</th>
        <th style='border:1px solid #ccc;padding:8px'>Saat</th>
        <th style='border:1px solid #ccc;padding:8px'>Ders</th>
        <th style='border:1px solid #ccc;padding:8px'>Şube</th>
      </tr></thead>
      <tbody>
        ${cart.map(r=>`<tr>
          <td style='border:1px solid #ccc;padding:8px'>${r.day}</td>
          <td style='border:1px solid #ccc;padding:8px'>${r.time}</td>
          <td style='border:1px solid #ccc;padding:8px'>${r.course}</td>
          <td style='border:1px solid #ccc;padding:8px'>${r.section}</td>
        </tr>`).join('')}
      </tbody>
    </table>
  `;

  document.body.appendChild(printable);
  const canvas = await html2canvas(printable,{scale:2});
  const img = canvas.toDataURL("image/png");
  const pdf = new jsPDF("p","pt","a4");
  const pageWidth = pdf.internal.pageSize.getWidth();
  const ratio = pageWidth / canvas.width;
  pdf.addImage(img,"PNG",0,0,canvas.width*ratio,canvas.height*ratio);
  pdf.save("ders_programi.pdf");
  printable.remove();
};
</script>

</body>
</html>